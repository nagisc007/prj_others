# -*- coding: utf-8 -*-
"""Story: The kissmark
"""
import os
import sys
sys.path.append(os.path.join(os.path.dirname(__file__), '../..'))
sys.path.append('storybuilder')

from storybuilder.builder import world as wd
from src.cobalt import config as cnf
THM = cnf.THEMES


# scenes
def sc_intro(w: wd.World):
    h = hana = w.hana
    mizu = w.mizukawa
    return w.scene("キスマークを嫌う",
            h.be(w.stage.ks_home, w.day.current),
            h.be("冷蔵庫を開けるとドリンク用のスペースに水のペットボトルが隙間なく入っていた。",
                "その一本を手に取り、砂を呑み込んだ後のような喉を掃除する。",
                "胃袋まで唾液混ざりの液体が押し流されて、微睡みから抜けた気分がいくらかすっきりした"),
            mizu.talk("ねえ、花"),
            h.be("大嫌いな自分の名前を呼ばれ、俺は布団に包まったままの何も身に付けていない女の頭を掴む。",
                "金髪を気取って染めたショートヘアはうまく髪が引っ張れなかったが、"),
            hana.talk("名前で呼ぶなっつっただろ"),
            h.be("少女漫画みたいな派手なマスカラの目は謝罪の色に染まったから、それで満足だった"),
            mizu.talk("ごめん、蜂須賀（はちすが）君"),
            hana.talk("悪かったよ"),
            h.be("そう言ってから、彼女の薄い体に腕を回す。",
                "脂肪が少なくて皮膚がかさついているのに、胸だけはシリコンでも入れたみたいに膨らんでいた。",
                "その二つの小さな突起を軽く吸う。",
                "ちょっとだけ濡れて、しっとりとした"),
            mizu.talk("する？"),
            hana.talk("水川がしたいんだろ。", "昨夜やりすぎたからいい"),
            mizu.think("そっか"),
            h.be("ぼてっとした唇が声なく形作る。",
                "食べたくなるくらいに、そこだけを愛していた。",
                "水川憂芽（みずかわゆめ）という女の、たった一部分だけが好物だった。",
                "でもそれを正直に伝えても彼女は「うれしい」と悦ぶ。",
                "それからつんと目を閉じてその唇を差し出す"),
            h.be("キスを、待っている"),
            h.think("けれどそれを俺が与えることはない。", "キスは、嫌いだ"),
            mizu.talk("一度聞きたかったんだけど、どうしてリップ塗るの？"),
            h.be("素肌にボタンシャツを合わせたままリップクリームでかさついた口を誤魔化している俺に、水川が背中からまとわりついてくる"),
            hana.talk("気持ち悪いから"),
            h.be("その剥き出しの乳房を引き剥がして立ち上がる"),
            hana.talk("服着ろ。飯食い行く"),
            h.be("俺はボタンを留めながらクロゼットの方に歩いて", "彼女の足音が遠ざかるのを待った"),
            mizu.talk("シャワー、借りても？"),
            h.be("振り返る。", "右の人差し指と親指でボタンを掴み、左の指で広げた穴に突っ込んでいく。",
                "彼女はその仕草をじっと見つめながら、俺が頷くのを待っている。",
                "いつもそうだ。",
                "返事をするまでずっとこっちの目を覗き込み",
                "待てと命じられた犬のように飼い主の合図を待っている"),
            h.be("不安。怯え。恐怖。",
                "それとも隷属だろうか"),
            h.deal("永遠に続くかと思われた沈黙を素っ気なく破って「ああ」と頷くと",
                "彼女は瞳を潤ませて「うん」と答えてバスルームに向かう"),
            h.think("そう。", "ただ、関わりが欲しいだけだ"),
            h.be("与えられるのを、いつでも待っている。",
                "水川憂芽はそんな女だ。",
                "そしてそんな女のことを$Sは一ミリも愛していない"),
            h.be("すぐにシャワーの水音が聴こえ始め", "それに愛らしい舌足らずな鼻歌が混ざった"),
            )

def sc_senpai(w: wd.World):
    h = hana = w.hana
    mizu, kitami = w.mizukawa, w.kitami
    return w.scene("先輩の電話",
            h.deal("シャツを着終えると乱れた布団を畳んで端に寄せる。",
                "水川が必死に掴むものだからシーツは彼女の手形が残るんじゃないかと思うくらいの皺を作っていた"),
            h.deal("ゴミ箱に入っているティッシュには昨夜の残滓がこびりついている。",
                "それでももっと沢山出したんじゃないかと思って覗き込んだが", "既に渇いてしまったのか", "それともその程度でしかなかったのか",
                "小さな円筒形をいっぱいにする程ではなかった"),
            h.deal("上着を手に取ろうとしたところで電話が鳴る。",
                "画面を見ると大学のサークルの先輩だった"),
            hana.talk("喜多見（きたみ）さん、ども。",
                "来週の清掃ボランティアのことですか？"),
            kitami.talk("いや。ほらお前テストの過去問欲しいって言ってたろ。",
                "手に入ったから、渡すわ"),
            h.deal("電話から響く声に不機嫌さはなかった。",
                "怒らせると恐い人だからと先輩たちから注意されていたが",
                "何故か一度もそういった経験がなかった。",
                "気に入られてるんだよ。", "そう言われたけれど",
                "水川みたいな女以外に$Sを気に入る人間なんてそういない"),
            hana.talk("ああ、助かります。えっと、大学で？"),
            kitami.talk("当たり前だろ……てかお前、また休んでんのかよ。いい加減にしとかないと単位落とすぞ"),
            hana.talk("一年の時に先生に土下座して単位貰った先輩の言葉は現実味あり過ぎです"),
            h.look("返事もなく通話が切れる。",
                "液晶に表示された時刻を確認すると既に十二時を少し過ぎていた"),
            )

def sc_ramen(w: wd.World):
    h = hana = w.hana
    mizu, kitami = w.mizukawa, w.kitami
    return w.scene("ラーメン屋",
            w.tag.symbol("◆"),
            h.be(w.stage.ks_ramen),
            # TODO:
            h.be("大学の前にある中華そば屋は満席で、俺と水川はカウンターの一番隅に座った。",
                "注文した和風醤油ラーメンは大きな海苔が一枚乗せられていて、これが湿気を含んでパリパリ感が失われるのが何とも嫌なのだが、麺と出汁の味がまずまずなので我慢する"),
            mizu.talk("ねえ"),
            hana.talk("食べてる時に話しかけんなよ"),
            mizu.talk("……ごめん"),
            h.be("猫舌の水川は蓮華に麺を乗せ、それを散々吹き冷ましてから何とか口に運ぶ。",
                "息を掛ける時にくっと突き出される分厚い紅色の唇にはたっぷりとグロスが塗り込まれていたが、そこに絡まり合った麺の塊が突っ込まれ、じゅるり、と口内に吸い込まれる。",
                "てらりとしたコーティングが付着したそれは、きっと水川の中を汚すだろう"),
            mizu.talk("ん？　なぁに？"),
            h.look("そんな$Sの視線に気づいて彼女がマスラカの多い目を向けた"),
            hana.talk("うまそうだなって"),
            mizu.talk("花……蜂須賀君のも、同じ醤油味だけど"),
            hana.talk("ああ"),
            h.be("不機嫌になって麺を啜る。",
                "味なんて感じない。",
                "胃袋を満たせればそれだけでいい。",
                "熱だけが、体に取り入れられるみたいだ。",
                "あまり考えると胃がむかつくから、無心で麺を啜る。",
                "嚥下する度に動く喉を、水川が羨ましそうに見つめていた"),
            mizu.talk("ねえ"),
            hana.talk("何だよ"),
            h.be("麺はまだ丼の中を泳いでいたが、今度は怒ったりはしない"),
            mizu.talk("なんでキス、駄目なの？"),
            hana.talk("嫌いだから"),
            mizu.talk("じゃあせめてキスマークくらい"),
            hana.talk("それはもっと嫌い"),
            h.be("水川はいつも泣きそうになる"),
            h.be("ただ怯えた子犬を前にしても俺はきっと素通りしてしまうだろう。",
                "泣いたって、同情なんか貰えない。",
                "人生そんな甘いもんじゃない"),
            hana.talk("……分かったよ"),
            h.be("何も分かっていないけど、そう言うことで水川は表情が輝く。",
                "不気味なマスカラお化けみたいな金髪の女の白い顔で、花びらのように唇が咲く"),
            mizu.talk("いい？"),
            hana.talk("違う"),
            mizu.talk("じゃあ何"),
            hana.talk("教えてやるよ、俺のトラウマ"),
            h.think("これを話せばまた離れていく。",
                "女なんて、そんなもんだ"),
            )

def sc_oldtalk(w: wd.World):
    h = hana = w.hana
    mizu, mitsu, kitami = w.mizukawa, w.mitsu, w.kitami
    return w.scene("昔話",
            w.tag.symbol("※"),
            h.be("あれは$Sが小学五年の時だった"),
            h.be("クラスでキスマークを付ける遊びが一時期だけ流行した。",
                "誰が始めたか、どこから伝播してきたのか、全然知らない。",
                "ただ、男子同士、女子同士、異性間、そんなこと関係なく、目立つように体にマークを付け合うのが楽しかったんだろう"),
            h.be("そんな遊び、俺は大嫌いだった"),
            h.be("そもそも小さい頃から女みたいと言われ、それはこの「花」っていう名前の所為もあったんだろうけど、とにかくよくイジられた。",
                "それも男子よりも女子からのイジりの方が酷かった"),
            h.be("当時みんなに「ミッツ」と呼ばれてるボス猿的存在の女子がいて、実際身長も百六十くらいあったんじゃないだろうか。",
                "何度も学校に親が呼びつけられる程度には、みんなから恐れられていた"),
            h.be("確か梅雨の時期の、珍しく蒸し暑い日だった"),
            h.be("俺は女子に手を引っ張られて体育倉庫に連れ込まれた。",
                "昼休みだったと思う"),
            h.be("ドッヂボールやバスケットボール、バレーなんかで賑わっていた声が、鉄の重い扉を閉めると遠くなって、そこで待っていたミッツが何を言ったのか、はっきり聞こえたよ"),
            mitsu.talk("花も欲しいでしょ、キスマーク"),
            h.be("また標的になった"),
            h.be("そんな気分だった"),
            h.be("しばらく他の男子に対象が移っていたのに、どうしてまた自分に戻ってきたんだろう。",
                "とにかく我慢していれば、時間が過ぎれば、チャイムが鳴れば、先生が見に来れば、終わる。",
                "そうとしか思わなかった。",
                "逃げるとか抵抗するとか、そんな無意味なことは考えなかった"),
            h.be("さっさと、やればいい"),
            mitsu.talk("気に入らないんだよ"),
            h.be("知ってるよ"),
            mitsu.talk("服、脱いでよ。", "キスマークつけれない"),
            h.be("ミッツ以外に五人、だったかな。",
                "じっと俺を見て、へらへらとしてる。",
                "スカートから伸びた足で何度か蹴りつけて「さっさとしてよ」って。", "誰も助ける気なんかない"),
            h.be("俺は諦めてボタンを外し、上着を脱いだ"),
            mitsu.talk("それも"),
            h.be("下着も、脱いだ。",
                "というか、頭で引っかかってなかなか抜けないから、苛ついた誰かが脱がした"),
            h.be("ズボンだけになった俺をミッツが押し倒すと、背中に跳び箱が当たった。",
                "そのまま右手で押さえつけて、右のここ、鎖骨の下に口を付けた。",
                "ちゅうっ、と吸われる。唾液と唇が、温かい。それが熱になり、やがて痛みに変わる"),
            h.be("俺が顔を顰めると、周りの女子たちが湧き立った"),
            mitsu.talk("これでわたしのモノ"),
            h.be("そう笑って見下ろしてから、他の女子たちにもキスマークを付けろって命令して、手や足に同級生の女子の唇が張り付いた。",
                "チュッチュと音をさせて、時にはキュゥって吸い込んで、うまく付かないともう一度とミッツに言われる"),
            h.be("いくつ付けたら終わるんだろう"),
            h.be("そんなことを考えながらぼんやりしていたら、チャイムが鳴ってみんな倉庫を出て行った"),
            h.be("それからも事ある毎にどこかに連れ込まれ、キスマークを付けられた"),
            h.be("教室に戻ると首筋や手首、頬や額のそれを見て、誰ともなくヒューヒューって囃し立てる。",
                "誰も俺が虐められているとは言わない"),
            h.be("巻き込まれるのが嫌だから？"),
            h.be("違うな。あれは共犯者だからだ。", "楽しいんだよ。そんな目してる奴しかいなかった"),
            h.be("たぶん泣いて喚いて困らせてやればよかったんだろう。", "けどそんなことをする気力もなかった"),
            h.be("夏休みに入る、少し前だった"),
            h.be("放課後になって帰ろうとしていたところを、ミッツたちに捕まった。",
                "ランドセルを抱えたまま連れて行かれたのは中庭にあった一輪車倉庫で、誰がくすねてきたのか知らないが、鍵を開けて、中に押し込まれた"),
            h.be("ああ、またか"),
            h.be("そう思って目を閉じたら、その日はミッツが自分で俺の服を脱がし始めた。",
                    "ランドセルを放り投げられて中の物が散乱したけど、誰一人それを気にする様子もなく、倒れた$Sの上に跨ってボタンを無理矢理に引きちぎってシャツを剥がし、"),
            mitsu.talk("脱げよ！　さっさと裸になんなさいよ！"),
            h.be("やけに苛立って、シャツを頭から引き抜いて、それでも飽き足りずにズボンも引っ張って脱がせた。",
                    "俺は白いブリーフだけになって、けど、ミッツは他の女子に手足を押さえつけさせて、全部脱がしてしまった"),
            h.be("情けない小さなものを見て、それを靴の裏で踏みつけたよ"),
            mitsu.talk("キスマーク付けてって、言いなさいよ"),
            h.be("言わなきゃ終わらない"),
            h.be("でも言ったところで、終わらない"),
            h.be("黙っていたら、首筋に噛み付くようにしてミッツがむしゃぶりついてきた。",
                    "吸血すんのかってくらいに強烈に吸い付いて、一瞬意識が失くなるかと思ったよ"),
            h.be("他の女子にもやらせるのかと思ったら、そのまま胸の上を吸って、それからお腹の上、徐々に下半身の方に降りていって、彼女は俺の股間のモノをぎゅっと握ったまま、内側の腿に吸い付いた。",
                    "その生温かい手に、思わず白いものが飛び出てミッツの頬に付着した。",
                    "髪にもたぶん、掛かったと思う"),
            h.be("彼女はそれを手で掬い取って、俺の口に突っ込んだ。",
                    "苦くて、あんなもん初めて食ったから、訳分からなくなって涙が出てきて、それでもミッツは止めなかった"),
            h.be("笑いながらキスマークを付けて、そのうちに馬乗りになってがむしゃらに首の辺りを何度も吸った。",
                    "俺はそんな中で勃起して、何度も出したよ"),
            h.be("狂気だね"),
            mizu.talk("ねえ、ミッツ。もうやめようよ"),
            h.be("あまりに怖かったんだろう。仲間の女子が言い出して、けど彼女は聞く耳なんかもたずに、息が荒くなるのも構わずにキスマークを作り続けて"),
            mizu.talk("これヤバイって。ごめんだわ"),
            h.be("そんな彼女からは、流石に取り巻きたちも逃げ出した。",
                    "けれどミッツはやめなかった。",
                    "それをしなければ自分自身がどうにかされるんじゃないかってくらいの勢いで",
                    "荒い息をさせながら何度も何度も", "$Sにキスをした"),
            h.be("いつまで続けてたのかは知らない。",
                    "どこからキスマークじゃなくなったのかも分からない。",
                    "力がなくなっても", "彼女はただただその行為を続けた"),
            h.think("$Sは泣きながら気絶していたみたいで",
                    "声を掛けられて目を覚ましたら救急隊の人がいて運び出されるところだった"),
            h.be("そのまま俺は学校を休んで、二学期の途中から少しずつ登校を再開した"),
            h.be("けどもう学校に、彼女はいなかった。", "ミッツはいなくなっていた"),
            h.be("あとで他の女子から親が離婚して色々あったんだって聞いたけど、ほんとかどうか$Sは知らない"),
            )

def sc_gotouniv(w: wd.World):
    h = hana = w.hana
    mizu, mitsu, kitami = w.mizukawa, w.mitsu, w.kitami
    return w.scene("大学に向かう",
            w.tag.symbol("※"),
            h.be("大学のキャンパスまで歩いて来たけど、午後の授業中だからか誰もベンチにはいなかった"),
            hana.talk("な、引いただろ？"),
            h.be("そこに座って水川にラーメン屋で話せなかった続きを全て話し終えると、俺はからりと笑う"),
            kitami.talk("おう、デート中だったか。そりゃ失礼したわ"),
            h.be("先輩は俺の姿を見つけて手を上げながらやってくる。",
                "その手には頼んでおいた講義の過去問だろう。紙の束が握られていて、俯いたままの水川を気にしながらも手渡してくれた"),
            hana.talk("すんません"),
            h.deal("小さく下げた頭を軽く叩き", "眼鏡の奥の目が鋭い$ln_kitamiが尋ねる"),
            kitami.talk("この子。この前連れてきてた子か。サークル入るの？"),
            mizu.talk("えっと"),
            h.deal("水川は助けを求めるように$Sを見てくるから",
                "仕方なく代わりに答えてやる"),
            hana.talk("サークルは軽音入ってるらしいんで"),
            kitami.talk("あっそ"),
            h.deal("先輩はそのまま立ち去るかと思ったが", "水川が気に入ったのか",
                "彼女の前に立ったまま$Sに週末の清掃ボランティアに参加するように言ってくる"),
            hana.talk("今週はちょっと"),
            kitami.talk("ちょっとって何だよ？",
                "彼女とデートか？", "そんな暇あったらお前ちゃんと勉強しろよ。",
                "留年なんてなったらかっこつかないぞ"),
            h.deal("話しながらもちらちらと彼女のシャツの中を覗き込む"),
            kitami.talk("じゃあさ",
                "こいつの代わりに出てみる？"),
            mizu.talk("え？　$meですか？"),
            h.be("見た目は派手に思われるけど、水川はあまり対人関係が得意じゃない"),
            kitami.talk("そうだよ。", "真面目そうだしレポートとかは大丈夫でしょ？",
                "サークル入らなくてもいいから", "体験ってやつで"),
            h.deal("水川は困った様子で何度も$Sに助けて欲しいと視線を投げる。",
                "$Sが小さく首を横に振ると", "凍えたような声で「遠慮します」と絞り出した"),
            kitami.talk("そう？",
                "ま、いいけど。あ、そうだ。蜂須賀君は女に優しくないから気をつけなよ。",
                "この前の彼女なんてさ"),
            hana.talk("先輩"),
            kitami.talk("おお、悪い。他人事だから口出さないでおくけど、引きずり回して迷惑掛けるのだけはやめろよ"),
            hana.talk("分かってますって"),
            kitami.talk("じゃ"),
            h.be("先輩は小走りに文化部の部室棟へと戻って行った"),
            mizu.talk("ねえ"),
            hana.talk("喜多見さん結構適当なこと言うから、あんま気にすんな"),
            mizu.talk("じゃなくて、その……キスマークの話"),
            h.be("ああ"),
            h.be("俺は辺りを見回してから立ち上がると、水川の手を引いて講義棟に入った"),
            h.be("廊下にはどこかの部屋で心理学だか社会学だかの授業の声が響いている"),
            hana.talk("えー、虐待には身体的虐待、精神的虐待、性的虐待、ネグレクトの四種類があり……"),
            )

def sc_kissmark(w: wd.World):
    h = hana = w.hana
    mizu, mitsu, kitami = w.mizukawa, w.mitsu, w.kitami
    return w.scene("キスマーク",
            h.be(w.stage.oncorridor),
            h.be("通路の一番奥まで歩いていき、そこの教室に誰もいないことを確認する"),
            mizu.talk("え？"),
            h.be("ドアを開けて中に入った"),
            hana.talk("入れよ"),
            mizu.talk("う、うん"),
            h.be("水川を机に座らせると、別の机の上に過去問の束を放り出して$Sは自分のシャツのボタンを外す"),
            mizu.talk("は……蜂須賀君"),
            h.be("露出した鎖骨の下の黒く細い染みに、彼女の指を這わせる"),
            hana.talk("これ。そん時のキスマークの痕。ここだけ消えないんだよ"),
            h.be("目を潤ませて、同情でもしてくれているんだろうか"),
            h.be("すると彼女はそこを舐めようと口を近づける"),
            hana.talk("やめろって"),
            h.be("顔を押しやり、俺はボタンを留めた"),
            mizu.talk("何でよ。付き合ってくれてるのに、どうして駄目なの？"),
            hana.talk("小学生の時に嫌いになったものを今更好きになれっての、無理だろ"),
            mizu.talk("じゃあ、代わりに、してよ"),
            h.be("水川は真剣な表情で薄いブラウスを脱いで、それから背中に腕を回してブラのホックを外そうとする。",
                "花柄のブラジャーはたわわな胸を支えているが、カチリ、という音を聞いてそれが脱力した"),
            mizu.talk("ねえ。キスマーク、つけてよ。知ってるよ。",
                "ほんとは、ずっとキスしたかったんでしょ？"),
            h.be("大きな黒目だな、と思っていた。ふっくらした唇が、震えている"),
            mizu.talk("さっきの話。",
                "本当はミッツもこうして花がキスマークつけてくれるの待ってたんじゃないの？",
                "ただされるがままを受け入れているだけの花から本当の愛をもらいたかったんじゃないの？"),
            hana.talk("何が本当の愛だよ？　いきなり何言い出すんだよ。俺を虐めるのが楽しかっただけだよ"),
            mizu.talk("虐めるのが愛情表現な人だっているじゃないの！"),
            h.be("大きな声だった"),
            h.be("水川は俺の肩を二度押しやり、少しよろめいたのを見てそのまま床に押し倒した。",
                "シャツを掴むとそのまま左右に開いてボタンを飛ばす"),
            hana.talk("……なん、だよ"),
            h.be("顎が震えた"),
            hana.talk("やめろ、よ……"),
            mizu.talk("わたしが……ミッツだよ"),
            h.be("低い声だった"),
            h.be("それに続いて水川は胸の上に唇をつける。",
                "唾液が温くて、鼓動が早まる。",
                "俺は押しのけようと彼女の胸を持ち上げるがそれ以上力が入らない。",
                "吸われる。体が、あの日の一輪車倉庫を思い出す"),
            mizu.talk("花……"),
            h.deal("彼女は熱っぽい声を発して",
                "$Sの胸元に吸い付く。",
                "音を立て", "唾液をからませ", "じゅるじゅると汚く吸う。",
                "けれどそんな音が出るというのは上手く吸えていないからで",
                "水川は$Sにキスマークを付けられない"),
            h.be("何度挑戦したのだろう。どれくらいの時間そうやってされるがままだったろう。",
                "頭がぼんやりとして、彼女に頬を触られてから自分がここにいると気づいた"),
            hana.talk("キスマーク……"),
            h.be("水川に言われ、胸元を見た。やっと一つだけ付いた小さな赤い染みが見つかる"),
            hana.talk("違う"),
            mizu.talk("え……"),
            hana.talk("こんなのじゃない"),
            h.deal("途中から分かっていた。", "彼女は違うって"),
            hana.talk("これは、俺が待ってたやつじゃない……お前、ミッツじゃないんだろ？"),
            mizu.talk("何で！"),
            h.be("そう叫んで俺の胸を叩く。「わたしがミッツでいいじゃない！」叩く。「わたしをあなたのミッツにしてよ！」何度も。「あの頃は彼女がずっと恐くて本当のこと言い出せなかったけど、やっと今、花を手に入れたのに」叩くことを止めない。「何で！　何でわたしじゃ駄目なのよ！」"),
            h.be("叩こうとした手を、受け止めた"),
            hana.talk("ミッツのキスマークはもっと鋭くて、全然優しくなんてないんだよ"),
            h.be("体を起こして水川の背中に腕を回すと、そのまま抱き締める。",
                    "彼女の胸が押し潰されて、その圧力が心地良い"),
            hana.talk("あいつのどうしようもなく攻撃的な、苛立ちや怒りに任せたキスマークの味は、俺が母親にされたそれに、とてもよく似てたんだよ"),
            mizu.talk("はは、おや？"),
            hana.talk("浮気しまくった挙句にヤクザの女に手を出して殺された男を愛した、可哀想な女のことだよ。",
                    "あいつは俺を親父代わりにしたんだよ。",
                    "まだ何も分からない俺を、愛してるっていう言葉で縛り付けて、自分のぬめった股間を顔に押し付けて、よがってやがったんだよ！"),
            h.be("水川の手が、俺の背中に爪を立てた"),
            hana.talk("でもそれを我慢したら、ご褒美だって菓子パンやインスタントラーメンをくれた。",
                    "俺にとって、それが唯一の飯だったんだ……"),
            h.be("爪は更にきつくなり、背中の皮を引き裂いた。",
                    "その心地良い痛みに応えて強く抱き締める"),
            hana.talk("だから……ずっと待ってたんだ。",
                    "けど、帰ってこなかった"),
            h.be("水川の手を振り解いて、押し倒す"),
            h.look("その瞳は涙で濡れて右目のマスカラが取れている"),
            hana.talk("同情してるのか？", "$Sのこと可哀想なヤツだって思ってんだろ！"),
            h.deal("自分の中に刻まれたあの時のミッツが蘇る"),
            h.deal("ブラジャーの花柄に手を置いて", "露出した素肌に唇を合わせる。",
                    "そこに思い切り歯を立てた"),
            h.hear("あ", "という小さな声を上げた彼女は覚悟をしたように目を閉じたが",
                    "$Sの中のミッツは止まらない。",
                    "思い切り噛み付いて", "痛いと言われても噛み付いて",
                    "血が舌先に触れた"),
            h.deal("それを吸い", "鉄臭い味が広がると頭の中が真っ赤になって",
                    "$Sは必死に吸い付いた"),
            mizu.talk("うれしい……"),
            h.deal("痛いでも苦しいでもなくそう呟いて", "水川は胸を震わせる"),
            h.deal("$Sは止まらない。止められない"),
            mizu.talk("……うん。いいよ。もっと、シテ"),
            h.be("嫌と言わず", "ただ受け入れる。",
                    "まるであの時の$Sだ"),
            mizu.talk("好き。あなたのそれをずっと、待ってたから"),
            h.deal("$Sは答えず", "ただ必死にキスマークを作る"),
            mizu.talk("うん……"),
            h.be("血を啜る"),
            h.be("唇が真っ赤に濡れてもなお、吸った"),
            h.be("いくら吸っても、俺の乾きは癒えない"),
            mizu.talk("わたしを、壊して"),
            h.be("ああ。そうだ。",
                    "$Sは未だにミッツを探している。",
                    "あのキスマークを", "求めているんだ。（了）"),
            # NOTE: 家族関係のもう少し丁寧な説明と以前に多少のフラグめいたもの
            # NOTE: ミッツじゃないと見破った後の水川の告白、そして彼女が転校した後に亡くなったことの告白
            )

# episodes
def ep_intro(w: wd.World):
    return (w.chaptertitle("冒頭"),
            sc_intro(w),
            w.hana.explain(w.info("彼女にキスさせない")),
            )

def ep_ramen(w: wd.World):
    return (w.chaptertitle("ラーメン屋"),
            sc_senpai(w),
            sc_ramen(w),
            )

def ep_oldstory(w: wd.World):
    return (w.chaptertitle("昔話"),
            sc_oldtalk(w),
            w.hana.explain(w.info("キスマークのトラウマを語る")),
            )

def ep_univ(w: wd.World):
    return (w.chaptertitle("大学生"),
            sc_gotouniv(w),
            )

def ep_kissmark(w: wd.World):
    return (w.chaptertitle("キスマーク"),
            sc_kissmark(w),
            w.hana.explain(w.info("彼女が$n_mitsuと告白する")),
            w.hana.explain(w.info("彼女のキスマークを否定する")),
            )

# outline
def story_baseinfo(w: wd.World):
    return [
            ("story", story(w), w.hana, w.mizukawa),
            ]

def story_outline(w: wd.World):
    return [
            ("story", story(w),
                w.hana.explain(w.info("彼女にキスさせない")),
                w.hana.explain(w.info("キスマークのトラウマを語る")),
                w.hana.explain(w.info("彼女が$n_mitsuと告白する")),
                w.hana.explain(w.info("彼女のキスマークを否定する")),
                True),
            ]

# main
def story(w: wd.World):
    return (w.maintitle("キスマーク"),
            ep_intro(w),
            ep_ramen(w),
            ep_oldstory(w),
            ep_univ(w),
            ep_kissmark(w),
            )

def main(): # pragma: no cover
    from src.cobalt.story import world
    w = world()
    return w.build(story(w))


if __name__ == '__main__':
    import sys
    sys.exit(main())

